<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Results Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Test Results Dashboard</h1>

  <!-- Test Status (Pass/Fail) Chart -->
  <h2>Test Status</h2>
  <canvas id="statusChart" width="400" height="200"></canvas>

  <!-- Test Execution Time Chart -->
  <h2>Test Execution Time (ms)</h2>
  <canvas id="executionTimeChart" width="400" height="200"></canvas>

  <!-- Performance Metrics Chart -->
  <h2>Performance Metrics (Page Load & Time to First Byte)</h2>
  <canvas id="performanceChart" width="400" height="200"></canvas>

  <script>
    function loadTestData() {
      // Fetch the test performance data (basic scraping test as an example)
      fetch('basic-scraping-performance.json')
        .then(response => response.json())
        .then(data => {
          const status = data.status === 'passed' ? 1 : 0;
          const executionTime = data.executionTime;
          const { pageLoadTime, timeToFirstByte } = data.performance;

          // Display Test Status (Pass/Fail)
          const statusCtx = document.getElementById('statusChart').getContext('2d');
          new Chart(statusCtx, {
            type: 'pie',
            data: {
              labels: ['Passed', 'Failed'],
              datasets: [{
                data: [status, 1 - status],  // Passed vs Failed
                backgroundColor: ['rgba(75, 192, 192, 0.6)', 'rgba(255, 99, 132, 0.6)'],
                borderWidth: 1
              }]
            },
            options: {
              responsive: false,
              maintainAspectRatio: false,
            }
          });

          // Display Test Execution Time
          const executionCtx = document.getElementById('executionTimeChart').getContext('2d');
          new Chart(executionCtx, {
            type: 'bar',
            data: {
              labels: [data.testName],
              datasets: [{
                label: 'Execution Time (ms)',
                data: [executionTime],
                backgroundColor: 'rgba(75, 192, 192, 0.6)',
                borderWidth: 1
              }]
            },
            options: {
              responsive: false,
              maintainAspectRatio: false,
            }
          });

          // Display Performance Metrics (Page Load & Time to First Byte)
          const performanceCtx = document.getElementById('performanceChart').getContext('2d');
          new Chart(performanceCtx, {
            type: 'bar',
            data: {
              labels: ['Page Load Time', 'Time to First Byte'],
              datasets: [{
                label: 'Performance (ms)',
                data: [pageLoadTime, timeToFirstByte],
                backgroundColor: ['rgba(54, 162, 235, 0.6)', 'rgba(255, 206, 86, 0.6)'],
                borderWidth: 1
              }]
            },
            options: {
              scales: {
                y: { beginAtZero: true }
              },
              responsive: false,
              maintainAspectRatio: false,
            }
          });
        })
        .catch(error => console.error('Error fetching test data:', error));
    }

    // Load test data when the page loads
    loadTestData();

    // Optional: Add a refresh button to reload the data manually
    document.getElementById('refreshButton')?.addEventListener('click', () => {
      loadTestData();
    });
  </script>
</body>
</html>
